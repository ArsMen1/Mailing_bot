from random import choice
from mailing_bot.shp_mailing_bot.config import RESPONSIBLE_FOR_THE_BOT

TOP_BAR_NPS = 80  # –≤—ã—Å–æ–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç -- –æ—Ç 80 –∏ –≤—ã—à–µ
MEDIUM_BAR_NPS = 65  # —Å—Ä–µ–¥–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç -- –æ—Ç 65 –¥–æ 80
# –Ω–∏–∑–∫–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç -- –º–µ–Ω—å—à–µ 65

# —Å—Ä–µ–¥–Ω–∏–π NPS +15 –∏ -10

TOP_BAR_RETIREMENT = 3
MEDIUM_BAR_RETIREMENT = 8


def ok_message() -> str:
    ok_phrases = (
        '–û–∫',
        '–ü—Ä–∏–Ω—è—Ç–æ',
        '–í—Å—ë —è—Å–Ω–æ',
        '–í–æ—Å–ø—Ä–∏–Ω—è—Ç–æ',
        '–ü–æ–Ω—è—Ç–Ω–æ –≤—Å—ë',
        '–ê–≥–∞, –ø–æ–Ω—è—Ç–Ω–æ',
        '–û–∫, —Å–ø–∞—Å–∏–±–æ',
        '–û–±—â–µ–ø–æ–Ω—è—Ç–Ω–æ',
        '–°—Ö–≤–∞—á–µ–Ω–æ',
        '–ü—Ä–∏–Ω—è—Ç–æ',
        '–î–æ—Å—Ç—É–ø–Ω–æ',
        '–®–ü–∞—Å–∏–±–æ, –≤—Å—ë –ø–æ–Ω—è—Ç–Ω–æ'
    )

    return choice(ok_phrases)


def kd_link_message() -> str:
    DB_PHRASES = (
        '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞.',
        '–û–π! –ö–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑—ã –Ω–∞ –æ–¥–Ω—É –º–∞–ª–µ–Ω—å–∫—É—é –∫–Ω–æ–ø–∫—É –ø—Ä–µ–≤—ã—à–µ–Ω–∞ ü§ì',
        '–ë–∞–∑–∞ –ó–Ω–∞–Ω–∏–π –æ–±–∏—Ç–∞–µ—Ç —Ç—É—Ç: ',
        '–í–æ—Ç —Å—Å—ã–ª–æ—á–∫–∞. –ò –±–æ–ª—å—à–µ –Ω–µ —Ç–µ—Ä—è–π—Ç–µ üôÉ',
        '–í–æ—Ç –∂–µ –æ–Ω–∞!',
        '–ù–∞–¥–µ—é—Å—å, –≤—ã –ø–æ–Ω–∏–º–∞–µ—Ç–µ, —á—Ç–æ –∑–∞—Ö–æ–¥–∏—Ç–µ –≤ —Ö—Ä–∞–º —Ü–µ–Ω–Ω–µ–π—à–∏—Ö –∑–Ω–∞–Ω–∏–π –®–ü. –í–µ–¥–∏—Ç–µ —Å–µ–±—è —Ç–∏—Ö–æ ü§´',
        '–ü–æ—Ç–µ—Ä—è–ª–∏ –ë–∞–∑—É –ó–Ω–∞–Ω–∏–π? –õ–∞–∞–¥–Ω–æ, –¥–µ—Ä–∂–∏—Ç–µ üòå',
        '–ó–Ω–∞–∫–æ–º—å—Ç–µ—Å—å, –≥–ª—É–±–æ–∫–æ —É–≤–∞–∂–∞–µ–º–∞—è –ë–∞–∑–∞ –ó–Ω–∞–Ω—å–µ–≤–Ω–∞ –®–ü–≤–æ–≤–Ω–∞üìñ: ',
        '–í–æ—Ç, –Ω–µ –±–ª–∞–≥–æ–¥–∞—Ä–∏—Ç–µ'
    )

    return choice(DB_PHRASES)


def evaluation_indicator(nps: str = None, retirement: str = None) -> str:  # get comment for nps or retirement
    # phrases
    excellent_indicators_comments = (
        '–ö–∞–π—Ñ :)',
        '–ü—Ä–µ–∫—Ä–∞—Å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç ü§©',
        '–¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!',
        '–í–∞—É –≤–∞—É üòÄ',
        '–í–∞—Å —Ç–∞–∫ –ª—é–±—è—Ç —É—á–µ–Ω–∏–∫–∏ ü•∞',
        '–û—Ç–ª–∏—á–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ üòå',
        '–û–≥–æ-–≥–æ, –∑–¥–æ—Ä–æ–≤–æ :)',
        '–ó–∞–º–µ—á–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ ‚ò∫Ô∏è',
        '–í—ã—Å—à–∏–π –ø–∏–ª–æ—Ç–∞–∂ ‚úàÔ∏è',
        '–ù–∏—á–µ–≥–æ —Å–µ–±–µ, –≤–æ—Ç —ç—Ç–æ –∫–ª–∞—Å—Å!',
        '–û–π, –∏–∑–≤–∏–Ω–∏—Ç–µ, –ø—Ä–æ—Å—Ç–∏—Ç–µ, —è —á—Ç–æ, —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞—é —Å –Ω–∞—Ä–æ–¥–Ω—ã–º –ª—é–±–∏–º—Ü–µ–º??',
        '–ê –º–æ–∂–Ω–æ –≤–∞—à –∞–≤—Ç–æ–≥—Ä–∞—Ñ?)',
        '–í–∞—É, –∫—Ä—É—Ç–æ üòÑ',
        '–≠—Ç–æ –∏—Å—Ç–æ—Ä–∏—è –ø—Ä–æ —É—Å–ø–µ—Ö üòé',
        '–û–±—Ä–∞–∑—Ü–æ–≤–æ-–ø–æ–∫–∞–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç)',
        '–Æ—Ö—É—É ü§†',
        '–ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ üôÇ',
        '–ó–∞ –≤–∞–º–∏ —É–∂–µ –≤—ã–µ—Ö–∞–ª–∞ –ø–æ–ª–∏—Ü–∏—è –∑–∞ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è —Ö–æ—Ä–æ—à–µ—Å—Ç–∏!!!',
        '–ó–Ω–∞–µ—Ç–µ, —è —Ö–æ—Ç–µ–ª –±—ã, —á—Ç–æ–±—ã –º–µ–Ω—è —Ç–æ–∂–µ —Ç–∞–∫ –∫—Ç–æ-–Ω–∏–±—É–¥—å –ª—é–±–∏–ª –∫–∞–∫ –≤–∞—Å –ª—é–±—è—Ç –¥–µ—Ç–∏ ü•∫'
    )

    good_indicators_comments = (
        '–•–æ—Ä–æ—à–∏–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ ‚ò∫Ô∏è',
        '–ù–µ–ø–ª–æ—Ö–æ!',
        '–ó–¥–æ—Ä–æ–≤–æ–æ–æ',
        '–ù–µ–ø–ª–æ—Ö–æ–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç üôÇ',
        '–°—Ç–∞–±–∏–ª—å–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏, –∑–¥–æ—Ä–æ–≤–æ)',
        '–û—á–µ–Ω—å –Ω–µ–ø–ª–æ—Ö–æ. –î–∞–ª—å—à–µ ‚Äî –±–æ–ª—å—à–µ üí™',
    )

    bad_indicators_comment = (
        '–°—Ç–æ–∏—Ç –ø–æ–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ –±—ã—Ç—å –∫ —Å–≤–æ–∏–º —É—á–µ–Ω–∏–∫–∞–º ü•∫',
        '–°—Ç–æ–∏—Ç –∑–∞–¥—É–º–∞—Ç—å—Å—è, –≤ —á–µ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ üôÑ',
        '–ú–æ–∂–Ω–æ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫–∞—Ç—å –µ—â—ë –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ–±—è—Ç–∞–º. –ù–µ–ø–æ–±–µ–¥–∏–º—ã—Ö –Ω–µ –±—ã–≤–∞–µ—Ç üí™',
        '–í—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∑–∞ –ø–æ–º–æ—â—å—é :)'
    )

    if nps and nps[-1] == '%':
        nps = float(nps.replace(',', '.')[:-1])
    if retirement and retirement[-1] == '%':
        retirement = retirement.replace(',', '.')[:-1]

    if (nps and nps >= TOP_BAR_NPS) or \
            (retirement and float(retirement) < TOP_BAR_RETIREMENT):
        return choice(excellent_indicators_comments)

    elif (nps and
          MEDIUM_BAR_NPS <= nps < TOP_BAR_NPS) or \
            (retirement and
             MEDIUM_BAR_RETIREMENT > float(retirement) >= TOP_BAR_RETIREMENT):
        return choice(good_indicators_comments)

    elif (nps and nps < MEDIUM_BAR_NPS) or \
            (retirement and float(retirement) >= MEDIUM_BAR_RETIREMENT):
        return choice(bad_indicators_comment)


def indicators_message(nps: str,
                       retirement: str,
                       average_nps: str,
                       average_retirement: str,
                       redflags: str) -> tuple:
    """
    Returnes a message and an indicators flag (are there indicators or not)
    """

    redflags_message = ''
    if redflags and redflags != "0":
        redflags_message = f'\n\n*–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–¥—Ñ–ª–∞–≥–æ–≤ ‚Äî {redflags}.*\n' \
                           f'–î–ª—è —É—Ç–æ—á–Ω–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏—á–∏–Ω–∞–º –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–µ—Ñ–¥–ª–∞–≥–æ–≤ ' \
                           f'–æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –≤–∞—à–µ–º—É —Ä—É–∫–æ–≤–æ–¥–∏—Ç–µ–ª—é.'

    if not nps and not retirement:
        return '–û–π, –Ω–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ –≤–∞—à–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ üëâüèªüëàüèª\n\n' \
               '–ï—Å–ª–∏ –≤—ã –ø—Ä–µ–ø–æ–¥–∞—ë—Ç–µ –ø–µ—Ä–≤—ã–π —Å–µ–º–µ—Å—Ç—Ä, —Ç–æ –ø—Ä–æ—Å—Ç–æ –¥–æ–∂–¥–∏—Ç–µ—Å—å –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å–µ–º–µ—Å—Ç—Ä–∞. ' \
               '–í–∞—à–∏ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ —Ç–æ–ª—å–∫–æ —Ñ–æ—Ä–º–∏—Ä—É—é—Ç—Å—è\n\n' \
               f'–í –ø—Ä–æ—Ç–∏–≤–Ω–æ–º —Å–ª—É—á–∞–µ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π –≤ –±–∞–∑—É –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ {RESPONSIBLE_FOR_THE_BOT}.', \
               False  # indicators flag
    else:
        if nps and retirement:
            nps_evaluation = evaluation_indicator(nps=nps)
            retirement_evaluation = evaluation_indicator(retirement=retirement)

            return f'*–í–∞—à NPS ‚Äî {nps}*.\n' \
                   f'–°—Ä–µ–¥–Ω–∏–π NPS –ø–æ —à–∫–æ–ª–µ ‚Äî {average_nps}.\n' \
                   f'üí≠ `{nps_evaluation}`\n\n' \
                   f'*–í–∞—à–∞ –≤—ã–±—ã–≤–∞–µ–º–æ—Å—Ç—å ‚Äî {retirement}*.\n' \
                   f'–°—Ä–µ–¥–Ω—è—è –≤—ã–±—ã–≤–∞–µ–º–æ—Å—Ç—å –ø–æ —à–∫–æ–ª–µ ‚Äî {average_retirement}.\n' \
                   f'üí≠ `{retirement_evaluation}`' + redflags_message, \
                   True  # indicators flag
        elif nps and not retirement:
            return f'*–í–∞—à NPS ‚Äî {nps}*.\n' \
                   f'–°—Ä–µ–¥–Ω–∏–π NPS –ø–æ —à–∫–æ–ª–µ ‚Äî {average_nps}.\n' \
                   f'üí≠ `{evaluation_indicator(nps=nps)}`\n\n' \
                   '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –≤–∞—à–µ–π –≤—ã–±—ã–≤–∞–µ–º–æ—Å—Ç–∏ —è –Ω–µ –Ω–∞—à—ë–ª üßê \n' \
                   f'–ï—Å–ª–∏ –≤—ã –¥—É–º–∞–µ—Ç–µ, —á—Ç–æ —ç—Ç–æ –æ—à–∏–±–∫–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫  {RESPONSIBLE_FOR_THE_BOT}' + \
                   redflags_message, \
                   True  # indicators flag
        elif retirement and not nps:
            return f'*–í–∞—à–∞ –≤—ã–±—ã–≤–∞–µ–º–æ—Å—Ç—å ‚Äî {retirement}*.\n' \
                   f'–°—Ä–µ–¥–Ω—è—è –≤—ã–±—ã–≤–∞–µ–º–æ—Å—Ç—å –ø–æ —à–∫–æ–ª–µ ‚Äî {average_retirement}.\n' \
                   f'üí≠ `{evaluation_indicator(retirement=retirement)}\n\n`' \
                   '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø–æ –≤–∞—à–µ–º—É NPS —è –Ω–µ –Ω–∞—à—ë–ª üßê\n' \
                   f'–ï—Å–ª–∏ –≤—ã –¥—É–º–∞–µ—Ç–µ, —á—Ç–æ —ç—Ç–æ –æ—à–∏–±–∫–∞, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫  {RESPONSIBLE_FOR_THE_BOT}' + \
                   redflags_message, \
                   True  # indicators flag


def current_group_detailing_nps_message() -> str:
    return '–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –≥—Ä—É–ø–ø–∞–º (M203 –≤—ã –∑–∞—à–ª–∏, –∞ –ê302 —Å—á–∏—Ç–∞—é—Ç, —á—Ç–æ –≤—ã –æ—Ç—Å—Ç–æ–π)'


def get_current_nps_message() -> str:
    return '–£ –≤–∞—Å –æ—Ç–ª–∏—á–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞. –ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ, –ø—Ä–∏—à–ª–∏—Ç–µ —Å–º—Å –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω 150-64-32.'


def grade_info_message() -> str:
    n = ' ' * 8

    return '*–ì—Ä–µ–π–¥ 3:*\n' + \
           n + 'NPS >=83%\n' + \
           n + '–í—ã–±—ã–≤–∞–µ–º–æ—Å—Ç—å <= 7%\n' + \
           n + '*ü§ë –ü—Ä–µ–º–∏—è ‚Äî 30%*\n\n' + \
           '*–ì—Ä–µ–π–¥ 2:*\n' + \
           n + 'NPS >= 72%\n' + \
           n + '–í—ã–±—ã–≤–∞–µ–º–æ—Å—Ç—å <= 10%\n' + \
           n + '*üí∞ –ü—Ä–µ–º–∏—è ‚Äî 15%*\n\n' + \
           '*–ì—Ä–µ–π–¥ 1:*\n' + \
           n + 'NPS  >= 60%\n' + \
           n + '–í—ã–±—ã–≤–∞–µ–º–æ—Å—Ç—å <= 13%\n' + \
           n + '*üíµ –ü—Ä–µ–º–∏—è ‚Äî 5%*\n\n' + \
           '*–ì—Ä–µ–π–¥ 0:*\n' + \
           n + 'NPS  < 60%\n' + \
           n + '–í—ã–±—ã–≤–∞–µ–º–æ—Å—Ç—å > 13%\n' + \
           n + '*üí∏ –ü—Ä–µ–º–∏—è ‚Äî 0%*\n\n' + \
           '*–ò—Ç–æ–≥–æ–≤—ã–π –≥—Ä–µ–π–¥ ‚Äî –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–∑ –¥–≤—É—Ö –≥—Ä–µ–π–¥–æ–≤ –ø–æ NPS –∏ –ø–æ –≤—ã–±—ã–≤–∞–µ–º–æ—Å—Ç–∏.*\n–ù–∞–ø—Ä–∏–º–µ—Ä, –ø–æ –≤—ã–±—ã–≤–∞–µ–º–æ—Å—Ç–∏ –≥—Ä–µ–π–¥ 2, –∞ –ø–æ NPS ‚Äî 3. –ò—Ç–æ–≥–æ–≤—ã–π –≥—Ä–µ–π–¥ ‚Äî 2.\n–¢–∞–∫–∂–µ –Ω–∞ –∏—Ç–æ–≥–æ–≤—ã–π –≥—Ä–µ–π–¥ –≤–ª–∏—è—é—Ç —Ä–µ–¥—Ñ–ª–∞–≥–∏.\n\n' \
           '_–ó–∞ –±–æ–ª–µ–µ –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥–ª—è–Ω—É—Ç—å –≤ —Å—Ç–∞—Ç—å—é –≤ –ë–∞–∑–µ –ó–Ω–∞–Ω–∏–π. –°—Å—ã–ª–∫–∞ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–∞ –∫ –∫–Ω–æ–ø–∫–µ –Ω–∏–∂–µ._'
